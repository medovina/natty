using div;

Definition (greatest common divisor).  Let a, b, d : â„¤.  d is a gcd of a and b if and only if d â‰¥ 0 and d | a and d | b and for all c : â„¤, if c | a and c | b then c | d.

Theorem (gcd is unique).  Let a, b, d, d' : â„¤.  Suppose that d is a gcd of a and b, and d' is a gcd of a and b.  Then d = d'.

Proof.  We know that d | d' and d' | d.  Hence by [mutual divisibility] d' = d or d' = âˆ’d.  Suppose that d' = âˆ’d.  We know that 0 â‰¤ d, so d' = âˆ’d â‰¤ 0.  But 0 â‰¤ d', so d' = 0, so d' = d.  Hence in all cases d' = d.

Theorem.  Let a, b, d : â„¤.

    a. 0 is the gcd of 0 and 0.
    b. If a > 0 then the gcd of 0 and a is a.   [gcd of 0 and positive]
    c. If a < 0 then the gcd of 0 and a is âˆ’a.  [gcd of 0 and negative]
    d. If a â‰  0 then the gcd of 0 and a is |a|.
    e. The gcd of 1 and a is 1.
    f.  Suppose that a â‰  0 or b â‰  0, and d is the gcd of a and b.   Then d > 0.

Proof.

    c. Suppose that a < 0.  Then âˆ’a > 0, so âˆ’a â‰¥ 0.  Also âˆ’a | 0 and âˆ’a | a.  Now let c : â„¤, and suppose that c | 0 and c | a.  Then by [divides difference] c | (0 âˆ’ a), so c | âˆ’a.  So âˆ’a is the gcd of 0 and a.

    d. Suppose that a â‰  0.  Then by [trichotomy on â„¤] either a > 0 or a < 0.  If a > 0 then by [gcd of 0 and positive] the gcd of 0 and a is |a|.  If a < 0 then by [gcd of 0 and negative] the gcd of 0 and a is |a|.

    f. We know that d â‰¥ 0.  Suppose that d = 0.  If a â‰  0 then 0 | a, which is a contradiction.  If b â‰  0 then 0 | b, which is a contradiction.  In any case we have a contradiction, so d â‰  0.  Then d > 0.

# BÃ©zout's theorem, Wiedijk #60

Theorem (BÃ©zout).  Let a, b : â„¤.  Suppose that a â‰  0 or b â‰  0.  Then there exist d, x, y : â„¤ such that d is the gcd of a and b and d is positive and d = xa + yb.

Proof.  Let A = { z : â„¤ | z = xa + yb for some x, y : â„¤ }.  We know that a > 0 or a < 0 or b > 0 or b < 0.  If a > 0 then 1 Â· a + 0 Â· b = a > 0.  If a < 0 then âˆ’1 Â· a + 0 Â· b = âˆ’a > 0. If b > 0 then 0 Â· a + 1 Â· b = b > 0.  If b < 0 then 0 Â· a + (âˆ’1) Â· b = âˆ’b > 0.  So in any case there is some z : â„¤ such that z âˆˆ A and z > 0.

Let B = { x âˆˆ A | x > 0 }.  Then B âŠ† ğ’² and B is nonempty.  So by [least number principle on â„¤] there exists some d : â„¤ such that d is a least element of B.  Clearly d is positive.  d âˆˆ A, so there exist x, y : â„¤ such that d = xa + yb.  Let c : â„¤.  If c | a and c | b then c | (xa + yb), so c | d.

By [division] there exist q, r : â„¤ such that a = qd + r and 0 â‰¤ r < d.  Hence a = q(xa + yb) + r.  Then r = a âˆ’ q(xa + yb), so r = (1 âˆ’ qx) Â· a + (âˆ’yq) Â· b.  Thus r âˆˆ A.  Suppose that r > 0.  Then r âˆˆ B.  But r < d, which is a contradiction since d is a least element of B.  Therefore r = 0. Thus a = qd, so d | a.

By [division] there exist q, r : â„¤ such that b = qd + r and 0 â‰¤ r < d.  Hence b = q(xa + yb) + r.  Then r = b âˆ’ q(xa + yb), so r = (1 âˆ’ qy) Â· b + (âˆ’xq) Â· a.  Thus r âˆˆ A.  Suppose that r > 0.  Then r âˆˆ B.  But r < d, which is a contradiction since d is a least element of B.  Therefore r = 0. Thus b = qd, so d | b.

We have shown that d â‰¥ 0 and d | a and d | b and for all c : â„¤, if c | a and c | b then c | d.  This shows that d is the gcd of a and b.

Axiom.  There is a function gcd : â„¤ â¨¯ â„¤ â†’ â„¤ such that for all a, b, d : â„¤, d = gcd(a, b) if and only if d is the gcd of a and b.

Theorem (gcd equal if same divisors).  Let a, b, c, d : â„¤.  Suppose that for all e : â„¤, e | a and e | b if and only if e | c and e | d.  Then gcd(a, b) = gcd(c, d).

Proof.  Let g = gcd(a, b).  Then g â‰¥ 0 and g | a and g | b and for all e : â„¤, if e | a and e | b then e | g.  Clearly g | c and g | d.  Let e : â„¤, and suppose that e | c and e | d.  Then e | a and e | b, so e | g.  Therefore g = gcd(c, d).

Lemma (Euclidean step).  Let a, b : â„¤ with b > 0.  Then gcd(a, b) = gcd(b, a mod b).

Proof.  Let e : â„¤.  We will show that e | a and e | b if and only if e | b and e | a mod b.  Suppose that e | a and e | b.  We know that a = (a div b) Â· b + (a mod b), so a mod b = 1 Â· a âˆ’ (a div b) Â· b, so by [divides linear combination] e | a mod b, so e | b and e | a mod b.  Now suppose that e | b and e | a mod b.  We know that a = (a div b) Â· b + 1 Â· (a mod b), so by [divides linear combination] e | a, so e | a and e | b.  Hence by [gcd equal if same divisors] gcd(a, b) = gcd(b, a mod b).

Axiom.  There exists a function egcd : â„¤ â¨¯ â„¤ â†’ â„¤ such that for all a, b : â„¤ with a > 0,

  a. egcd(a, 0) = a.
  b. If b > 0 then egcd(a, b) = egcd(b, a mod b).

# Greatest common divisor algorithm, Wiedijk #69

Theorem.  For all a, b : â„¤ with a > 0 and b â‰¥ 0, egcd(a, b) = gcd(a, b).

Proof.  Let S = { b âˆˆ ğ’² | for all a : â„¤ with a > 0, egcd(a, b) = gcd(a, b) }.  Clearly S âŠ† ğ’².  Let b âˆˆ ğ’², and suppose that x âˆˆ S for all x âˆˆ ğ’² with x < b.  Either b = 0 or b > 0.  Suppose that b = 0.  Let a : â„¤, and suppose that a > 0.  Then egcd(a, b) = a = gcd(a, b) by [gcd of 0 and positive]. So b âˆˆ S.

Now suppose that b > 0.  Let a : â„¤.  Suppose that a > 0.  We know that 0 â‰¤ a mod b < b.  Then

  egcd(a, b) = egcd(b, a mod b)
                   = gcd(b, a mod b) by the inductive hypothesis
                   = gcd(a, b) by [Euclidean step].
  
So b âˆˆ S.  Then by [strong induction on â„¤] S = ğ’².
