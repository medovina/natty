using card, gcd, rat;

Definition.  Let a, b : â„¤.  a and b are relatively prime if for all c : â„¤ with c > 0, if c | a and c | b then c = 1.

Lemma.  Let a, b : â„¤.  a and b are relatively prime if and only if the gcd of a and b is 1.

Proof.  Suppose that a and b are relatively prime.  1 | a and 1 | b.  Let c : â„¤.  Suppose that c | a and c | b.  By [trichotomy on â„¤] either c > 0 or c = 0 or c < 0.  If c > 0 then c = 1, so c | 1.  If c = 0 then a = 0 since c | a, but then 1 | 0, which is a contradiction.  If c < 0 then âˆ’c > 0 and âˆ’c | a and âˆ’c | b, so âˆ’c = 1, so c = âˆ’1, so c | 1.  Therefore c | 1.  So the gcd of a and b is 1.

Now suppose that the gcd of a and b is 1.  Let c : â„¤.  Suppose that c > 0 and c | a and c | b.  Then c | 1, so by [divisor of 1] c = 1.  So a and b are relatively prime.

Lemma.  Let a, b : â„¤.  Suppose that a and b are relatively prime.  Then a â‰  0 or b â‰  0.

Lemma.  Let a, b : â„¤.  a and b are relatively prime if and only if 1 = xa + yb for some x, y : â„¤.  [relatively prime iff linear combination is 1]

Proof.  Suppose that a and b are relatively prime.  Then the gcd of a and b is 1. Also a â‰  0 or b â‰  0.  Hence by [BÃ©zout] 1 = xa + yb for some x, y : â„¤.

Now suppose that 1 = xa + yb for some x, y : â„¤.  Let c : â„¤, and suppose that c > 0 and c | a and c | b.  By [divides linear combination] c | xa + yb, so c | 1.  Then by [divisor of 1] c = 1.  So a and b are relatively prime.

Theorem (lowest terms).  Let r : â„š.  There exist p, q : â„¤ such that q â‰  0 and r = p / q and p and q are relatively prime.

Proof.  There exist some a, b : â„¤ such that r = a / b and b â‰  0.

Let d : â„¤ = gcd(a, b).  Then d | a and d | b, so there exist p, q : â„¤ such that dp = a and dq = b.  Since b â‰  0 we have q â‰  0.  By [equality on â„š] a / b = p / q.  Now let e : â„¤, and suppose that e > 0 and e | p and e | q.  Then there exist k, l : â„¤ such that p = ke and q = le, so a = dke and b = dle.  So de | a and de | b.  Because d is the gcd of a and b, de | d.  So de | d Â· 1, so e | 1, so by [divisor of 1] e = 1.  Thus p and q are relatively prime.

Definition.  Let a : â„¤.  a is prime if and only if a > 1 and for all c : â„¤, if c > 0 and c | a then c = a or c = 1.  a is composite if and only if a is not prime.

Theorem.  2 is prime.

Proof.  Let c : â„¤, and suppose that c > 0 and c | 2.  Then by [divides implies â‰¤] c â‰¤ 2.  By [small integers] c = 0 or c = 1 or c = 2 or c > 2, however c â‰  0 and c â‰¯ 2, so c = 1 or c = 2.

Theorem (divisible by prime).  Let a : â„¤ with a > 1.  Then there is some p : â„¤ such that p is prime and p | a.

Proof.  Let A = { a : â„¤ | a > 1 and there is no p : â„¤ such that p is prime and p | a }.  Assume that A is not empty.  Suppose that x âˆˆ A.  Then x > 1 : â„¤ > 0, so by [< is transitive on â„¤] x > 0.  So A âŠ† ğ’².

By [least number principle on â„¤] there is some b : â„¤ such that b is a least element of A.  Then b > 1 and there is no p : â„¤ such that p is prime and p | b.

Suppose that b is prime.  But b | b, which is a contradiction.

Now suppose that b is not prime.  Then there is some c : â„¤ such that c > 0 and c | b and c â‰  b and c â‰  1.  If c < 1 then 0 < c < 0 + 1, which is a contradiction to [â„¤ is discrete], so we must have c > 1.  Since c | b, it follows by [divides implies â‰¤] that c < b.  Hence c âˆ‰ A, so there exists some d : â„¤ such that d | c and d is prime.  Then d | b, so b âˆ‰ A, which is a contradiction.

In any case we have a contradiction.  So A is empty.

Theorem (prime divides factor).  Let p, a, b : â„¤.  Suppose that p is prime and p | ab.  Then p | a or p | b.

Proof.  Suppose that p âˆ¤ a.  We must show that p | b.  Let c : â„¤ with c > 0, and suppose that c | p and c | a.  Since p is prime, c = p or c = 1.  If c = p then p | a, which is a contradiction.  So c = 1.  Consequently p and a are relatively prime. Hence by [relatively prime iff linear combination is 1] 1 = xp + ya for some x, y : â„¤. Therefore 1 Â· b = (xp + ya) Â· b, so b = xbp + yab.  We know that p | ab, so p | (xb)p + y(ab), so p | b.

Axiom.  For all a : â„¤ â†’ â„¤ and i, j : â„¤, the product aáµ¢ Â·Â·Â· aâ±¼ : â„¤ is defined as follows:

    a. If j < i then aáµ¢ Â·Â·Â· aâ±¼ = 1.
    b. If i â‰¤ j then aáµ¢ Â·Â·Â· aâ±¼ = (aáµ¢ Â·Â·Â· aâ±¼â‚‹â‚) Â· aâ±¼.

Lemma (product of positive sequence).  Let a : â„¤ â†’ â„¤.  Let i, j : â„¤.  Suppose that aâ‚– > 0 for all k: â„¤ with i â‰¤ k â‰¤ j.  Then aáµ¢ Â·Â·Â· aâ±¼ > 0.

Proof.  Either j < i or i â‰¤ j.  If j < i then aáµ¢ Â·Â·Â· aâ±¼ = 1 : â„¤ > 0.

Now assume that i â‰¤ j.  Let S = { k : â„¤ | aáµ¢ Â·Â·Â· aâ‚– > 0 }.  We know that aáµ¢ Â·Â·Â· aáµ¢ = (aáµ¢ Â·Â·Â· aáµ¢â‚‹â‚) Â· aáµ¢ = 1 Â· aáµ¢ = aáµ¢ > 0.  So i âˆˆ S.  Now let k âˆˆ S, and suppose that i â‰¤ k < j.  Then i < k + 1 â‰¤ j, so

    aáµ¢ Â·Â·Â· aâ‚–â‚Šâ‚ = aáµ¢ Â·Â·Â· aâ‚â‚–â‚Šâ‚â‚â‚‹â‚ Â· aâ‚–â‚Šâ‚
                         = aáµ¢ Â·Â·Â· aâ‚– Â· aâ‚–â‚Šâ‚
                          > 0 by [product of positives is positive].

So k + 1 âˆˆ S.  So by [induction on a range of â„¤] k âˆˆ S for all k : â„¤ with i â‰¤ k â‰¤ j.  Then j âˆˆ S, so aáµ¢ Â·Â·Â· aâ±¼ > 0. 

Lemma (product of sequences).  Let a : â„¤ â†’ â„¤.  Let i, j, k : â„¤ with i â‰¤ j â‰¤ k.  Then (aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚–) = aáµ¢ Â·Â·Â· aâ‚–.

Proof.  Let B = { x : â„¤ | (aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚“) = aáµ¢ Â·Â·Â· aâ‚“ }. We know that aâ±¼â‚Šâ‚ Â·Â·Â· aâ±¼ = 1, so (aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ±¼) = aáµ¢ Â·Â·Â· aâ±¼.  So j âˆˆ B.

Now let x âˆˆ B, and suppose that j â‰¤ x < k.  We know that i â‰¤ j â‰¤ x < x + 1, so by [â‰¤ with < are transitive on â„¤] i < x + 1.  Then

    (aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚“â‚Šâ‚)
        = (aáµ¢ Â·Â·Â· aâ±¼) Â· ((aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚â‚“â‚Šâ‚â‚â‚‹â‚) Â· aâ‚“â‚Šâ‚)
        = (aáµ¢ Â·Â·Â· aâ±¼) Â· ((aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚“) Â· aâ‚“â‚Šâ‚)
        = ((aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚“)) Â· aâ‚“â‚Šâ‚
        = (aáµ¢ Â·Â·Â· aâ‚“) Â· aâ‚“â‚Šâ‚  by the inductive hypothesis
        = (aáµ¢ Â·Â·Â· aâ‚â‚“â‚Šâ‚â‚â‚‹â‚) Â· aâ‚“â‚Šâ‚
        = aáµ¢ Â·Â·Â· aâ‚“â‚Šâ‚.

So x + 1 âˆˆ B.  Then by [induction on a range of â„¤] x âˆˆ B for all x : â„¤ with j â‰¤ x â‰¤ k.  So k âˆˆ B, so (aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚–) = aáµ¢ Â·Â·Â· aâ‚–.

Lemma (sequence divisor).  Let a : â„¤ â†’ â„¤.  Let i, j, k : â„¤.  Suppose that i â‰¤ j â‰¤ k.  Then aâ±¼ | aáµ¢ Â·Â·Â· aâ‚–.

Proof.

    aâ±¼ Â· ((aáµ¢ Â·Â·Â· aâ±¼â‚‹â‚) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚–))
        = ((aáµ¢ Â·Â·Â· aâ±¼â‚‹â‚) Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚–)
        = (aáµ¢ Â·Â·Â· aâ±¼) Â· (aâ±¼â‚Šâ‚ Â·Â·Â· aâ‚–)
        = aáµ¢ Â·Â·Â· aâ‚– by [product of sequences].

# The infinitude of primes, Wiedijk #11

Theorem.  { x : â„¤ | x is prime } is infinite.

Proof.  Let P = { x : â„¤ | x is prime }.  Assume that P is finite.  Then by [finite set] there is some k : â„¤ and q : â„¤ â†’ â„¤ such that P = { x : â„¤ | x = qáµ¢ for some i : â„¤ with 1 â‰¤ i â‰¤ k }.  Let i : â„¤, and assume that 1 â‰¤ i â‰¤ k.  Then qáµ¢ is prime, so qáµ¢ > 1, so qáµ¢ > 0 by [< is transitive on â„¤].  So qáµ¢ > 0 for all i : â„¤ with 1 â‰¤ i â‰¤ k.

Let

    u = qâ‚ Â·Â·Â· qâ‚– + 1.

By [product of positive sequence] qâ‚ Â·Â·Â· qâ‚– > 0, so u > 1.  By [divisible by prime] there is some p : â„¤ such that p is prime and p | u.  Hence there is some j : â„¤ with 1 â‰¤ j â‰¤ k such that p = qâ±¼.  Hence by [sequence divisor] p | qâ‚ Â·Â·Â· qâ‚–.  But

    1 = u âˆ’ (qâ‚ Â·Â·Â· qâ‚–)
       = 1 Â· u + (âˆ’1) Â· (qâ‚ Â·Â·Â· qâ‚–).
       
So by [divides linear combination] p | 1.  Since p is prime, p > 1, which is a contradiction.
