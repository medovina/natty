using int;

Definition.  For all a, b : â„¤, a | b iff there exists c : â„¤ such that b = ac.

Theorem.  Let a, b, c, x, y : â„¤.

    a. a | 0.
    b. 1 | a.
    c. a | a.
    d. If a | b and b | c then a | c.
    e. If c â‰  0 and a | c then |a| â‰¤ |c|.  [divides implies abs â‰¤]
    f. If 0 | c then c = 0.  [0 divides only 0]
    g. a | b and b | a if and only if a = b or a = âˆ’b. [mutual divisibility]
    h. a | a Â· b.
    i. If a | b and a | c then a | (b + c).  [divides sum]
    j. If a | b and a | c then a | (b âˆ’ c).  [divides difference]
    k. If a | 1 then a = 1 or a = âˆ’1.  [divisor of 1]
    l. If a | b then a | b Â· c.
    m. If a | b and a | c then a | (x Â· b + y Â· c).  [divides linear combination]
    n. If a > 0 and c > 0 and a | c then a â‰¤ c.  [divides implies â‰¤]
    o. If a â‰  0 and ab | ac then b | c.

Proof.

    d. Suppose that a | b and b | c.  Then there are some d, e : â„¤ such that b = ad and c = be.  Then c = (ad)e = a(de).  Hence a | c.

    e. Suppose that a | c and c â‰  0.  Then there exists some b : â„¤ such that c = ab.  Hence |c| = |a| Â· |b|.  c â‰  0, so b â‰  0.  We know that |b| â‰¥ 0, so we have |b| > 0.  Therefore by [< iff successor â‰¤ on â„¤] |b| â‰¥ 0 + 1 = 1 : â„¤.  Hence
    
        |c| = |a| Â· |b|
             â‰¥ |a| Â· 1  by [â‰¤ mul right on â„¤]
             = |a|.

    f. Suppose that 0 | c.  Then c = 0 Â· d for some d : â„¤, so c = 0.

    g. Suppose that a | b and b | a.  If a = 0 or b = 0 then by [0 divides only 0] a = 0 = b.  If a â‰  0 and b â‰  0 then by [divides implies abs â‰¤] |a| â‰¤ |b|, also by [divides implies abs â‰¤] |b| â‰¤ |a|, so by [trichotomy on â„¤] |a| = |b|, so a = b or a = âˆ’b.

    Now suppose that a = b.  Then clearly a | b and b | a.  Finally, suppose that a = âˆ’b.  Then a = âˆ’(1 Â· b) = âˆ’1 Â· b.  Also b = âˆ’a = âˆ’(1 Â· a) = âˆ’1 Â· a, so a | b and b | a.

    i. Suppose that a | b and a | c.  Then there exist d, e : â„¤ such that b = da and c = ea.  Then b + c = da + ea = (d + e) Â· a, so a | (b + c).

    j. Suppose that a | b and a | c.  Then there exist d, e : â„¤ such that b = da and c = ea.  Then b âˆ’ c = da âˆ’ ea = (d âˆ’ e) Â· a, so a | (b âˆ’ c).

    l. Suppose that a | b.  Then there exists x : â„¤ such that ax = b.  Then a(xc) = bc, so a | bc.

    m. Suppose that a | b and a | c.  Then a | xb and a | yc, so by [divides sum] a | (xb + yc).

    n. Suppose that a > 0 and c > 0 and a | c.  Then by [divides implies abs â‰¤] |a| â‰¤ |c|, so a = |a| â‰¤ |c| = c.

Definition.  For all a : â„¤, a is even if 2 | a.

Theorem (division).  Let a, b : â„¤.  Suppose that a > 0.  Then there exist q, r : â„¤ such that b = qa + r and 0 â‰¤ r < a.

Proof.  Let B = { b : â„¤ | b â‰¥ 0 and there exist q, r : â„¤ such that b = qa + r and 0 â‰¤ r < a }.  0 = 0 Â· a + 0 and 0 : â„¤ â‰¤ 0 < a, so 0 âˆˆ B.  Now let c âˆˆ B.  Then c â‰¥ 0, so c + 1 â‰¥ 0.  Also there exist q, r : â„¤ such that c = qa + r and 0 â‰¤ r < a.  Since r < a, it follows by [< iff successor â‰¤ on â„¤] that r + 1 â‰¤ a.

Suppose that r + 1 = a.  Then

    c + 1 = qa + (r + 1) = qa + a = (q + 1) Â· a + 0 and 0 : â„¤ â‰¤ 0 < a, so c + 1 âˆˆ B.

Now suppose that r + 1 < a.  Then

    c + 1 = qa + (r + 1) and 0 â‰¤ r + 1 < a, so c + 1 âˆˆ B.

In any case c + 1 âˆˆ B.  We know that B âŠ† ğ’², and we have shown that for all c âˆˆ B, c + 1 âˆˆ B.  So by [induction on â„¤] B = ğ’².

Either b â‰¥ 0 or b < 0.  Suppose that b â‰¥ 0.  Then b âˆˆ B, so there exist q, r : â„¤ such that b = qa + r and 0 â‰¤ r < a.

Now suppose that b < 0.  Then âˆ’b > 0, so âˆ’b âˆˆ B, so there exist q, r : â„¤ such that âˆ’b = qa + r and 0 â‰¤ r < a.

Either r = 0 or r > 0.  Suppose that r = 0.  Then âˆ’b = qa, so b = (âˆ’q) Â· a + 0, so there exist s, t : â„¤ such that b = sa + t and 0 â‰¤ t < a.

Now suppose that r > 0.  Then b = âˆ’(qa + r) = (âˆ’q) Â· a + (âˆ’r) = (âˆ’q) Â· a + (a âˆ’ r) âˆ’ a = (âˆ’q âˆ’ 1) Â· a + (a âˆ’ r).  Observe that a âˆ’ r < a since r > 0.  Also 0 < a âˆ’ r since r < a.  Therefore 0 â‰¤ a âˆ’ r < a.  So there exist s, t : â„¤ such that b = sa + t and 0 â‰¤ t < a.

Theorem (Uniqueness of Division).  Let a, b : â„¤.  Suppose that a > 0.  Suppose that there exist q, r, q', r' : â„¤ such that b = q Â· a + r = q' Â· a + r', and 0 â‰¤ r < a and 0 â‰¤ r' < a.  Then q = q' and r = r'.

Proof.  Notice that r' = b âˆ’ q' Â· a and r = b âˆ’ q Â· a, so r' âˆ’ r = q Â· a âˆ’ q' Â· a = (q âˆ’ q') Â· a.

Suppose that r' = r.  Then r' âˆ’ r = 0.  Hence (q âˆ’ q') Â· a = 0.  But a â‰  0.  Hence q âˆ’ q' = 0.  Therefore q = q'.

Now suppose that r â‰  r'.  Then r' âˆ’ r â‰  0, hence q âˆ’ q' â‰  0.  Therefore |q âˆ’ q'| â‰¥ 1, so |(q - q') Â· a| = |q - q'| Â· |a| â‰¥ 1 Â· |a| = a.  Thus |r' âˆ’ r| â‰¥ a.

We know that r' < a and âˆ’r â‰¤ 0, so r' âˆ’ r < a + 0 = a.  Likewise, r < a and âˆ’r' â‰¤ 0, so r âˆ’ r' < a + 0 = a.

However either |r' âˆ’ r| = r âˆ’ r' or |r' âˆ’ r| = r' âˆ’ r.  So |r' âˆ’ r| < a.  This is a contradiction.  So r' = r and q' = q.

Axiom.  There exist binary operations div, mod : â„¤ â†’ â„¤ â†’ â„¤ such that for all a, b : â„¤ with b > 0,

    a = (a div b) Â· b + (a mod b)    and    0 â‰¤ a mod b < b.

Definition (greatest common divisor).  Let a, b, d : â„¤.  d is a gcd of a and b if and only if d â‰¥ 0 and d | a and d | b and for all c : â„¤, if c | a and c | b then c | d.

Theorem (gcd is unique).  Let a, b, d, d' : â„¤.  Suppose that d is a gcd of a and b, and d' is a gcd of a and b.  Then d = d'.

Proof.  We know that d | d' and d' | d.  Hence by [mutual divisibility] d' = d or d' = âˆ’d.  Suppose that d' = âˆ’d.  We know that 0 â‰¤ d, so d' = âˆ’d â‰¤ 0.  But 0 â‰¤ d', so d' = 0, so d' = d.  Hence in all cases d' = d.

Theorem.  Let a, b, d : â„¤.

    a. 0 is the gcd of 0 and 0.
    b. If a > 0 then the gcd of 0 and a is a.   [gcd of 0 and positive]
    c. If a < 0 then the gcd of 0 and a is âˆ’a.  [gcd of 0 and negative]
    d. If a â‰  0 then the gcd of 0 and a is |a|.
    e. The gcd of 1 and a is 1.
    f.  Suppose that a â‰  0 or b â‰  0, and d is the gcd of a and b.   Then d > 0.

Proof.

    c. Suppose that a < 0.  Then âˆ’a > 0, so âˆ’a â‰¥ 0.  Also âˆ’a | 0 and âˆ’a | a.  Now let c : â„¤, and suppose that c | 0 and c | a.  Then by [divides difference] c | (0 âˆ’ a), so c | âˆ’a.  So âˆ’a is the gcd of 0 and a.

    d. Suppose that a â‰  0.  Then by [trichotomy on â„¤] either a > 0 or a < 0.  If a > 0 then by [gcd of 0 and positive] the gcd of 0 and a is |a|.  If a < 0 then by [gcd of 0 and negative] the gcd of 0 and a is |a|.

    f. We know that d â‰¥ 0.  Suppose that d = 0.  If a â‰  0 then 0 | a, which is a contradiction.  If b â‰  0 then 0 | b, which is a contradiction.  In any case we have a contradiction, so d â‰  0.  Then d > 0.

# BÃ©zout's theorem, Wiedijk #60

Theorem (BÃ©zout).  Let a, b : â„¤.  Suppose that a â‰  0 or b â‰  0.  Then there exist d, x, y : â„¤ such that d is the gcd of a and b and d is positive and d = xa + yb.

Proof.  Let A = { z : â„¤ | z = xa + yb for some x, y : â„¤ }.  We know that a > 0 or a < 0 or b > 0 or b < 0.  If a > 0 then 1 Â· a + 0 Â· b = a > 0.  If a < 0 then âˆ’1 Â· a + 0 Â· b = âˆ’a > 0. If b > 0 then 0 Â· a + 1 Â· b = b > 0.  If b < 0 then 0 Â· a + (âˆ’1) Â· b = âˆ’b > 0.  So in any case there is some z : â„¤ such that z âˆˆ A and z > 0.

Let B = { x âˆˆ A | x > 0 }.  Then B âŠ† ğ’² and B is nonempty.  So by [least number principle on â„¤] there exists some d : â„¤ such that d is a least element of B.  Clearly d is positive.  d âˆˆ A, so there exist x, y : â„¤ such that d = xa + yb.  Let c : â„¤.  If c | a and c | b then c | (xa + yb), so c | d.

By [division] there exist q, r : â„¤ such that a = qd + r and 0 â‰¤ r < d.  Hence a = q(xa + yb) + r.  Then r = a âˆ’ q(xa + yb), so r = (1 âˆ’ qx) Â· a + (âˆ’yq) Â· b.  Thus r âˆˆ A.  Suppose that r > 0.  Then r âˆˆ B.  But r < d, which is a contradiction since d is a least element of B.  Therefore r = 0. Thus a = qd, so d | a.

By [division] there exist q, r : â„¤ such that b = qd + r and 0 â‰¤ r < d.  Hence b = q(xa + yb) + r.  Then r = b âˆ’ q(xa + yb), so r = (1 âˆ’ qy) Â· b + (âˆ’xq) Â· a.  Thus r âˆˆ A.  Suppose that r > 0.  Then r âˆˆ B.  But r < d, which is a contradiction since d is a least element of B.  Therefore r = 0. Thus b = qd, so d | b.

We have shown that d â‰¥ 0 and d | a and d | b and for all c : â„¤, if c | a and c | b then c | d.  This shows that d is the gcd of a and b.

Axiom.  There is a function gcd : â„¤ â¨¯ â„¤ â†’ â„¤ such that for all a, b, d : â„¤, d = gcd(a, b) if and only if d is the gcd of a and b.

Theorem (gcd equal if same divisors).  Let a, b, c, d : â„¤.  Suppose that for all e : â„¤, e | a and e | b if and only if e | c and e | d.  Then gcd(a, b) = gcd(c, d).

Proof.  Let g = gcd(a, b).  Then g â‰¥ 0 and g | a and g | b and for all e : â„¤, if e | a and e | b then e | g.  Clearly g | c and g | d.  Let e : â„¤, and suppose that e | c and e | d.  Then e | a and e | b, so e | g.  Therefore g = gcd(c, d).

Lemma (Euclidean step).  Let a, b : â„¤ with b > 0.  Then gcd(a, b) = gcd(b, a mod b).

Proof.  Let e : â„¤.  We will show that e | a and e | b if and only if e | b and e | a mod b.  Suppose that e | a and e | b.  We know that a = (a div b) Â· b + (a mod b), so a mod b = 1 Â· a âˆ’ (a div b) Â· b, so by [divides linear combination] e | a mod b, so e | b and e | a mod b.  Now suppose that e | b and e | a mod b.  We know that a = (a div b) Â· b + 1 Â· (a mod b), so by [divides linear combination] e | a, so e | a and e | b.  Hence by [gcd equal if same divisors] gcd(a, b) = gcd(b, a mod b).

Axiom.  There exists a function egcd : â„¤ â¨¯ â„¤ â†’ â„¤ such that for all a, b : â„¤ with a > 0,

  a. egcd(a, 0) = a.
  b. If b > 0 then egcd(a, b) = egcd(b, a mod b).

# Greatest common divisor algorithm, Wiedijk #69

Theorem.  For all a, b : â„¤ with a > 0 and b â‰¥ 0, egcd(a, b) = gcd(a, b).

Proof.  Let S = { b âˆˆ ğ’² | for all a : â„¤ with a > 0, egcd(a, b) = gcd(a, b) }.  Clearly S âŠ† ğ’².  Let b âˆˆ ğ’², and suppose that x âˆˆ S for all x âˆˆ ğ’² with x < b.  Either b = 0 or b > 0.  Suppose that b = 0.  Let a : â„¤, and suppose that a > 0.  Then egcd(a, b) = a = gcd(a, b) by [gcd of 0 and positive]. So b âˆˆ S.

Now suppose that b > 0.  Let a : â„¤.  Suppose that a > 0.  We know that 0 â‰¤ a mod b < b.  Then

  egcd(a, b) = egcd(b, a mod b)
                   = gcd(b, a mod b) by the inductive hypothesis
                   = gcd(a, b) by [Euclidean step].
  
So b âˆˆ S.  Then by [strong induction on â„¤] S = ğ’².
